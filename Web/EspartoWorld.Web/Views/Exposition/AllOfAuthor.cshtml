@model EspartoWorld.Web.ViewModels.ExpositionItems.ExpositionItemViewModelPagination
@using Microsoft.AspNetCore.Mvc.Localization
@using  EspartoWorld.Data.Models
@inject IViewLocalizer localizer

@{
    ViewData["Title"] = localizer["All in exposition"];
}

<div class="container">
    <div class="row m-3">
        <div class="col-md-2">
            <form id="SearchForm" asp-action="AllOfAuthor" asp-controller="Exposition" method="get" asp-route-id="1" asp-route-author="@Model.AuthorID">
                <label for="ItemCategory">@localizer["Sort By:"] </label>
                <select onchange="Submit()" name="ItemCategory" id="ItemCategory" asp-items="@Html.GetEnumSelectList<Category>()" class="selectpicker">
                    <option value="0" selected>--</option>
                </select>
                <input type="hidden" name="author" value="@Model.AuthorID"/>
            </form>
        </div>
    </div>
    <div class="row text-center">
        @foreach (var item in Model.ExpositionItems)
        {
            <div class="col-md-6 col-lg-4 card-container">
                <div class="card card-flip border border-dark  m-2">
                    <div class="front card-block card-body d-flex flex-column">
                        <img src=@item.ImageUrl class="card-img-top img-fluid" />
                    </div>
                    <div class="back card-block card-body d-flex flex-column">
                        <h4 class="card-title m-2">@item.Title</h4>
                        <p class="card-text m-1"><b>@localizer["Author"]:</b> @item.Author.UserName</p>
                        <p class="card-text m-1">@item.Description</p>

                        @if (item.IsSold)
                        {
                            <h5 class="card-text text-muted m-1 mt-auto"><b>@localizer["SOLD"]</b></h5>
                        }
                        else
                        {
                            @*<h5 class="card-text text-danger m-1 mt-auto"><b>@item.Price &euro;</b></h5>

                                <button href="#" class="btn btn-primary mt-1">@localizer["Buy"]</button>*@
                            @if (User.Identity.Name == item.Author.UserName)
                            {
                                <form class="mt-auto" asp-controller="Exposition" asp-action="DeleteOwnItem" asp-route-itemId=@item.Id method="post">
                                    <button type="submit" class="btn btn-danger">@localizer["Delete"]</button>
                                </form>
                            }
                            else
                            {
                                <a class="mt-auto btn btn-success" asp-controller="Exposition" asp-action="AllOfAuthor" asp-route-author=@item.AuthorId>@localizer["All artworks of this author"]</a>
                            }
                        }
                    </div>
                </div>
            </div>
        }
    </div>
    <partial name="_PaginationPartial" model="@Model" />
</div>

@section Scripts{
    <script>
        document.getElementById("ItemCategory").value = @Model.ItemCategory

        function Submit() {
            document.getElementById("SearchForm").submit()
        }
    </script>
}


